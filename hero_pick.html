<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-type" content="text/html; charset=utf-8">
	<title>hero_pick</title>
	
	<script src="http://d3js.org/d3.v3.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
	<script src="http://underscorejs.org/underscore-min.js"></script>
	
	<style type="text/css" media="screen">
		body {
		  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
		  margin: auto;
		  position: relative;
		  width: 1400px;
		}
		
		text {
		  font: 10px sans-serif;
			color: white;
		}
		
	</style>
	<!-- Data is here. -->
	<script type="text/javascript" src="hero_picks.js"></script>
	<script type="text/javascript" src="hero_colors.js"></script>
	
	<!-- rendering is here. -->
	<script type="text/javascript" charset="utf-8">
		var numWeeks = 22;
		var width = 1400;
		var height = 800;
		
		var showNormalized = true;
		
		$("document").ready(function() {
			
			generateNormalizedStack();
			
		});
		
		
		function generateNormalizedStack() {
			var svg = d3.select("body").append("svg")
				.attr("width", width)
				.attr("height", height);
				
				var x = d3.scale.linear()
				    .domain([0, numWeeks - 1])
				    .range([0, width]);

				var y = d3.scale.linear()
				    .domain([0, 1])
				    .range([height, 0]);

				var color = d3.scale.linear()
				    .range(["#131", "#cfc"]);
						
				var area = d3.svg.area()
				    .x(function(d) { return x(d.x); })
				    .y0(function(d) { return y(d.y0); })
				    .y1(function(d) { return y(d.y0 + d.y); });
				
				var gpmRange = [1000, 0];
				_.each(heroes, function(hero) {
					if(hero.gpm < gpmRange[0]) gpmRange[0] = hero.gpm;
					if(hero.gpm > gpmRange[1]) gpmRange[1] = hero.gpm;
				});
				
			var stack = d3.layout.stack()
				.offset("expand")
				.order(function(data) {
					return d3.range(data.length);
				})
				.values(function(d) { return d.values;});
			
			var layers = stack(heroes);
			
			svg.selectAll("path")
				.data(layers)
				.enter().append("path")
					.attr("d", function(d) { return area(d.values)})
					.style("fill", function(d) {
						// 1000 is the max GPM we've got on the DB at the moment, so
						// averages will be well, well below that. 
						return color((d.gpm-gpmRange[0])/gpmRange[1]);
					})
					.append("text")
						.attr("dy", ".3em")
					  .style("text-anchor", "middle")
					  .text(function(d) { return d.heroName; });
		}
	</script>
</head>
<body id="hero_pick" onload="">
</body>
</html>